# 中南林业科技大学涉外学院校园网自动登录 · DrCOM（仅发布打包版）

这是面向中南林业科技大学涉外学院（SWXY）校园网的 DrCOM 自动认证工具套件。当前仓库仅发布打包版（.exe），无需安装 Python 环境即可直接运行，源码不随发行包发布。

- 适用范围：SWXY 校区需 DrCOM 认证的网络环境
- 发布形式：仅提供可执行打包版（DrCOMClient.exe、KeyGenerator.exe）
- 使用目标：自动检测网络并在断网时执行 DrCOM 认证重连

## 📦 文件说明

| 文件名 | 大小 | 功能描述 |
|--------|------|----------|
| **DrCOMClient.exe** | ~18MB | DrCOM认证客户端 - 主程序 |
| **KeyGenerator.exe** | ~12MB | 密钥生成器 - 创建加密的认证密钥文件 |

## 🌟 核心功能

### DrCOM认证客户端 (DrCOMClient.exe)
- 🔐 **安全认证** - 使用加密密钥文件进行DrCOM网络认证
- 🖥️ **图形界面** - 直观的GUI界面，实时显示网络状态
- 🔄 **自动重连** - 智能检测网络断开并自动重新认证
- 📊 **网络监控** - 实时监控网络连通性，支持多目标检测
- ⏰ **密钥管理** - 支持密钥有效期验证和倒计时显示
- 🛡️ **密码保护** - 支持自定义密码保护密钥文件

### 密钥生成器 (KeyGenerator.exe)
- 📝 **图形化创建** - 简单易用的界面输入账号密码
- 🔒 **AES加密** - 使用PBKDF2HMAC算法安全加密存储
- ⏱️ **精确有效期** - 支持天、时、分、秒级别的有效期设置
- 🔄 **自动重连配置** - 可选择是否启用自动重连功能
- 🛡️ **密码保护** - 可设置自定义密码保护密钥文件
- 📋 **密钥查看** - 支持查看现有密钥文件信息

## 🚀 快速开始

1. 生成密钥文件（KeyGenerator.exe）
   - 输入 DrCOM 账号和密码，设置有效期与是否自动重连
   - 可选设置保护密码
2. 启动认证客户端（DrCOMClient.exe）
   - 选择并加载密钥文件
   - 开启网络监控与自动重连（若密钥支持）
3. 程序将在网络异常或掉线时自动进行认证重试

## ⚙️ 系统要求

- 操作系统: Windows 10/11（推荐 64 位）
- 网络环境: SWXY 校园网（需 DrCOM 认证）
- 网络连通: 能够访问 SWXY 校园网认证入口
- 权限: 无需管理员权限即可运行

## 🔧 详细使用说明

### 密钥生成器使用
1. **账号密码**: 输入您的DrCOM认证账号和密码
2. **有效期设置**: 
   - 支持天、时、分、秒四个维度
   - 建议设置30天有效期
   - 最短1秒，最长365天
3. **自动重连**: 开启后客户端会自动检测网络断开并重连
4. **密码保护**: 
   - 可设置6位以上的保护密码
   - 防止他人使用您的密钥文件
   - 两次输入密码必须一致

### 认证客户端使用
1. **密钥加载**: 
   - 支持默认密码和自定义密码的密钥文件
   - 显示密钥有效期和剩余时间倒计时
2. **网络状态**: 
   - 实时显示网络连接状态
   - 显示认证状态和最后认证时间
3. **控制功能**:
   - **测试网络**: 手动测试当前网络连通性
   - **重新认证**: 手动触发DrCOM重新认证
   - **自动重连**: 开启/关闭自动重连功能
   - **网络监控**: 开启/关闭网络状态监控
4. **运行日志**: 实时显示程序运行状态和错误信息

## 🛡️ 安全特性

- **AES加密**: 密钥文件使用AES-256加密存储
- **PBKDF2算法**: 使用10万次迭代增强密码安全性
- **有效期控制**: 密钥文件支持精确的有效期管理
- **密码保护**: 可选的自定义密码保护功能
- **无明文存储**: 账号密码不会以明文形式保存

## 🔍 网络监控机制

- **多目标检测**: 同时ping多个可靠网站（百度、腾讯、网易等）
- **快速失败**: 优先检测最可靠的网站，快速判断网络状态
- **随机间隔**: 1-3秒随机检测间隔，避免网络拥塞
- **智能重试**: 失败时自动重试，减少误判
- **状态回调**: 网络状态变化时立即触发相应操作

## 🐛 故障排除

- 自动重连不工作
  - 确认密钥已启用“自动重连”
  - 确认网络监控处于开启状态
  - 查看日志是否存在“认证频率限制”提示（最小 4 秒间隔）

### 常见问题

**Q: 程序无法启动或被杀毒软件拦截？**
A: 
- 将程序添加到杀毒软件白名单
- 检查Windows Defender实时保护设置
- 确保从可信来源下载程序

**Q: 密钥文件加载失败？**
A: 
- 检查密钥文件是否损坏
- 确认输入的密码是否正确
- 检查密钥文件是否已过期

**Q: 认证失败？**
A: 
- 确认网络已连接到需要认证的WiFi
- 检查账号密码是否正确
- 确认认证服务器地址是否正确
- 查看运行日志中的详细错误信息

**Q: 自动重连不工作？**
A: 
- 确认密钥文件支持自动重连功能
- 检查网络监控是否已开启
- 查看日志确认网络状态检测是否正常

**Q: 网络监控显示异常？**
A: 
- 检查防火墙是否阻止ping命令
- 确认网络连接稳定性
- 尝试手动测试网络连通性

## 💡 使用技巧

1. **首次使用**: 建议先生成一个短期密钥文件进行测试
2. **密码保护**: 重要账号建议启用密码保护功能
3. **有效期管理**: 定期更新密钥文件，避免过期导致的认证失败
4. **日志查看**: 遇到问题时及时查看运行日志定位原因
5. **网络环境**: 确保在正确的网络环境中使用认证客户端

## 📝 更新日志

### v1.5.0 (当前版本)
- ✅ 完整的DrCOM认证功能
- ✅ 图形化密钥生成器
- ✅ 智能网络监控和自动重连
- ✅ AES加密密钥文件保护
- ✅ 修复subprocess调用导致的cmd窗口弹出问题
- ✅ 支持密码保护和有效期管理
- ✅ 实时网络状态显示和日志记录

---

🎯 **适用场景**: 校园网DrCOM认证、企业网络认证、需要定期重新认证的网络环境

💡 **提示**: 建议在使用前先了解您的网络环境认证要求，确保程序配置正确。
